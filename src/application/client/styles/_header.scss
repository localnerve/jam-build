// -------------
// header.scss
//
// Jam-build, a web application practical reference.
// Copyright (c) 2025 Alex Grant <info@localnerve.com>, LocalNerve LLC
// 
// This file is part of Jam-build.
// Jam-build is free software: you can redistribute it and/or modify it
// under the terms of the GNU Affero General Public License as published by the Free Software
// Foundation, either version 3 of the License, or (at your option) any later version.
// Jam-build is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
// without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
// See the GNU Affero General Public License for more details.
// You should have received a copy of the GNU Affero General Public License along with Jam-build.
// If not, see <https://www.gnu.org/licenses/>.
// Additional terms under GNU AGPL version 3 section 7:
// a) The reasonable legal notice of original copyright and author attribution must be preserved
//    by including the string: "Copyright (c) 2025 Alex Grant <info@localnerve.com>, LocalNerve LLC"
//    in this material, copies, or source code of derived works. 
// -------------
@use 'vars' as v;
@use 'colors' as c;
@use 'mixins' as m;
@use 'logo' as l;

$box-shadow: 0 0 4px rgb(0 0 0 / 14%), 0 4px 8px rgb(0 0 0 / 28%);

.ln-header::before {
  content: '';
  position: absolute;
  top: 0; right: 0; bottom: 0; left: 0; // stylelint-disable-line declaration-block-no-redundant-longhand-properties
  background-color: var(--site-bg);  
  will-change: box-shadow;
  opacity: 0.97;
  box-shadow: none;
  transition: box-shadow;
  
  @include m.breakpoint (medium) {
    will-change: opacity;
    opacity: 0;
    box-shadow: $box-shadow;
    transition: opacity 0.2s;
  }
}

.ln-header {
  position: sticky;
  position: -webkit-sticky; // stylelint-disable-line value-no-vendor-prefix
  top: 0;
  left: 0;
  right: 0;
  z-index: v.$z-index-header;

  .container {
    padding: .6em 1em .2em;
    display: flex;
    flex-flow: row wrap;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin: 0.5rem 0;

    @include m.min-width (1200px) { // large
      width: 1200px;
      margin: 0 auto;
    }

    @include m.breakpoint (medium-small) {
      flex-flow: row nowrap;
    }

    & > * {
      position: relative; // gets click target above flex-basis of h1
    }
  }

  .status {
    padding: 0 1em 0.2em;
    display: flex;
    flex-flow: row nowrap;
    align-items: center;
    justify-content: end;
    position: relative;
    width: 100%;

    @include m.min-width (1200px) { // large
      width: 1200px;
      margin: 0 auto;
    }

    p {
      margin: 0;
    }
  }

  // undo user-agent button styles
  button.menu {
    -webkit-appearance: none; // stylelint-disable-line property-no-vendor-prefix,plugin/no-unsupported-browser-features
    appearance: none; // stylelint-disable-line plugin/no-unsupported-browser-features
    border: none; background: transparent;
    padding: 0; margin: 0;
    text-align: left;
    color: var(--site-color);
  }
  
  .menu {
    display: block;
    flex: 1 1 auto;

    svg {
      width: 2.4em;
      height: 1.6em;
    }

    @include m.breakpoint (medium) {
      display: none;
    }
  }

  .icon {
    flex: 1 1 auto;

    &.phone {
      @include m.breakpoint (medium-large) {
        margin-left: 2em;
      }

      a {
        display: flex;
      }

      span {
        padding-top: 0.2rem;

        @include m.breakpoint(medium) {
          display: none;
        }

        @include m.min-width(56em) {
          display: inline;
        }
      }
    }

    svg {
      width: 1.5em;
      height: 1.5em;
    }
  }

  h1 {
    @include l.logo-block;

    // keep old sass behavior for properties that appear after nested rules [mixed-decls]
    // These override the logo-block output above
    & { // stylelint-disable-line no-duplicate-selectors,block-no-redundant-nested-style-rules
      flex: 1 1 36%;
      display: none;
    }

    .logo {
      .nl {
        @include m.breakpoint (medium) {
          color: var(--logo-blue);
        }
      }

      .nr {
        @include m.breakpoint (medium) {
          color: var(--logo-red);
        }
      }

      .symbol {
        @include m.breakpoint (medium) {
          color: c.$logo-red;
        }
      }
    }

    .logo-tag {
      @include m.breakpoint (medium) {
        color: var(--site-color);
      }
    }

    @include m.breakpoint (medium) {
      display: flex;
      transform: scale(1) translate(0, 26px);
      align-items: flex-start;
    }

    @include m.breakpoint (medium-large) {
      flex: 1 1 35%;
      transform: scale(1.4) translate(18%, 18px);
    }

    @include m.breakpoint (xlarge) {
      flex: 0 1 38%;
      transform: scale(1.6) translate(24%, 32px);
    }

    @include m.min-width (1600px) {
      transform: scale(1.6) translate(calc(23% - ((100vw - 1600px) * 0.1)), 35px);
    }
  }

  &~ h1:first-of-type {
    @include l.logo-block;

    // keep old sass behavior for properties that appear after nested rules [mixed-decls]
    // These override the logo-block output above
    & { // stylelint-disable-line no-duplicate-selectors,block-no-redundant-nested-style-rules
      margin: 0.5rem 1rem 1rem;
      padding-bottom: 0.5rem;
    }

    @include m.breakpoint (medium) {
      display: none;
    }
  }
} // .ln-header

.no-js .ln-header,
.ln-header.fixed {
  &::before {
    box-shadow: $box-shadow;

    @include m.breakpoint (medium) {
      opacity: 0.95;
    }
  }

  h1 {
    @include m.breakpoint (medium) {
      transform: scale(1.0) translate(4%, 0);
    }

    @include m.breakpoint (xlarge) {
      transform: scale(1.1) translate(8%, 0);
    }
 
    .logo {
      .nl {
        color: var(--logo-blue);
      }

      .nr {
        color: var(--logo-red);
      }

      .symbol {
        fill: var(--logo-red);
      }
    }

    .logo-tag {
      color: var(--site-color);
    }
  }
}

.no-js .ln-header {
  &~ h1:first-of-type {
    margin-top: 1rem;
  }

  /*
  .icon.logo {
    display: none;
  }
  */

  .menu {
    color: #bbb;
  }
}

.no-nav {
  button.menu {
    display: none;
  }

  .ln-header .icon {
    text-align: center;
  }

  /*
  .ln-header .icon.logo {
    display: none;
  }
  */

  .ln-header .icon.phone {
    display: flex;
    flex-flow: row nowrap;
    justify-content: center;
    align-items: center;

    span {
      display: inline;
      margin-left: 1rem;
      font-size: 1.4em;
    }
  }

  @include m.breakpoint (medium) {
    .ln-header h1 {
      flex: 1 1 auto;
    }
  }

  @include m.breakpoint (medium-large) {
    .ln-header h1 {
      flex: 1 1 25%;
    }
  }

  @include m.breakpoint (xlarge) {
    .ln-header h1 {
      flex: 0 1 38%;
    }
  }
}
